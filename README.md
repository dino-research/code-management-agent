# GitHub Agent - ADK Agent cho GitHub Integration

ƒê√¢y l√† m·ªôt ADK (Agent Development Kit) agent ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ t∆∞∆°ng t√°c v·ªõi GitHub repositories th√¥ng qua [github-mcp-server](https://github.com/github/github-mcp-server). Agent n√†y c√≥ th·ªÉ h·ªèi th√¥ng tin GitHub URL v√† Personal Access Token t·ª´ ng∆∞·ªùi d√πng, sau ƒë√≥ s·ª≠ d·ª•ng **MCPToolset** ƒë·ªÉ th·ª±c hi·ªán c√°c t√°c v·ª• GitHub.

## üöÄ T√≠nh nƒÉng

- **Thu th·∫≠p th√¥ng tin an to√†n**: H·ªèi GitHub URL v√† Personal Access Token t·ª´ ng∆∞·ªùi d√πng
- **Validation**: Ki·ªÉm tra t√≠nh h·ª£p l·ªá c·ªßa GitHub URL v√† token format
- **GitHub Integration**: S·ª≠ d·ª•ng github-mcp-server th√¥ng qua **MCPToolset** ƒë·ªÉ t∆∞∆°ng t√°c v·ªõi GitHub API
- **ƒêa d·∫°ng t√°c v·ª•**: H·ªó tr·ª£ clone repository, xem files, search code, qu·∫£n l√Ω commits, etc.
- **Giao di·ªán ti·∫øng Vi·ªát**: T∆∞∆°ng t√°c ho√†n to√†n b·∫±ng ti·∫øng Vi·ªát
- **MCPToolset Integration**: S·ª≠ d·ª•ng ADK MCPToolset ƒë·ªÉ k·∫øt n·ªëi v·ªõi github-mcp-server

## üìã Y√™u c·∫ßu

### Dependencies
- Python 3.11+
- Google ADK (`google-adk>=1.0.0`)
- github-mcp-server (c√†i ƒë·∫∑t t·ª´ [GitHub repository](https://github.com/github/github-mcp-server))

### C√†i ƒë·∫∑t github-mcp-server

#### Option 1: T·ª´ Go (Recommended)
```bash
# C√†i ƒë·∫∑t Go n·∫øu ch∆∞a c√≥
go install github.com/github/github-mcp-server/cmd/github-mcp-server@latest

# Verify installation
github-mcp-server --help
```

#### Option 2: Download Binary
1. Truy c·∫≠p [GitHub Releases](https://github.com/github/github-mcp-server/releases)
2. Download binary ph√π h·ª£p v·ªõi OS c·ªßa b·∫°n
3. ƒê·∫∑t binary v√†o PATH

#### Option 3: Build t·ª´ Source
```bash
git clone https://github.com/github/github-mcp-server.git
cd github-mcp-server
go build -o github-mcp-server ./cmd/github-mcp-server
# Copy binary v√†o PATH
```

## üîß C√†i ƒë·∫∑t

### 1. Clone repository n√†y
```bash
git clone <this-repo-url>
cd github-mcp-agent
```

### 2. C√†i ƒë·∫∑t dependencies
```bash
# S·ª≠ d·ª•ng setup script (recommended)
chmod +x setup.sh
./setup.sh

# Ho·∫∑c manual install
pip install -r requirements.txt
```

### 3. Verify github-mcp-server
```bash
# Ki·ªÉm tra github-mcp-server c√≥ trong PATH
which github-mcp-server
github-mcp-server --help
```

## üéØ Ki·∫øn tr√∫c

### Core Components

1. **github_agent/agent.py**: Main ADK agent v·ªõi MCPToolset integration
2. **github_agent/prompt.py**: System instructions v√† workflow prompts
3. **github_agent/tools.py**: Custom validation v√† setup tools
4. **MCPToolset**: ADK component ƒë·ªÉ k·∫øt n·ªëi v·ªõi github-mcp-server

### Flow Diagram

```
User Input ‚Üí GitHub Agent ‚Üí Custom Tools (validation/setup) ‚Üí MCPToolset ‚Üí github-mcp-server ‚Üí GitHub API
```

## üîë Thi·∫øt l·∫≠p GitHub Personal Access Token

### B∆∞·ªõc 1: T·∫°o Token
1. ƒêƒÉng nh·∫≠p GitHub.com
2. Settings ‚Üí Developer settings ‚Üí Personal access tokens ‚Üí Tokens (classic)
3. Generate new token (classic)

### B∆∞·ªõc 2: C·∫•u h√¨nh Permissions
- **repo**: Full control of private repositories ‚úÖ
- **read:org**: Read org and team membership ‚úÖ 
- **user:email**: Access user email addresses ‚úÖ
- **workflow**: Update GitHub Action workflows (optional)

### B∆∞·ªõc 3: L∆∞u Token
- Copy token: `ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`
- L∆∞u tr·ªØ an to√†n, kh√¥ng chia s·∫ª

## üöÄ S·ª≠ d·ª•ng

### Option 1: ADK Web UI (Recommended)
```bash
# Ch·∫°y trong th∆∞ m·ª•c ch·ª©a agent
adk web

# Truy c·∫≠p http://localhost:8000
# Ch·ªçn "github_agent" t·ª´ dropdown
```

### Option 2: Programmatic Usage
```python
import asyncio
from github_agent.agent import root_agent
from google.adk.runners import Runner

# Xem example_usage.py ƒë·ªÉ bi·∫øt chi ti·∫øt
```

### Option 3: Command Line
```bash
# Ch·∫°y example
python example_usage.py
```

## üí¨ Conversation Flow

1. **Agent h·ªèi GitHub URL**:
   ```
   User: "T√¥i mu·ªën l√†m vi·ªác v·ªõi repository GitHub"
   Agent: "B·∫°n c√≥ th·ªÉ cung c·∫•p GitHub repository URL kh√¥ng?"
   ```

2. **Agent h·ªèi Personal Access Token**:
   ```
   User: "https://github.com/microsoft/vscode"
   Agent: "T√¥i c·∫ßn GitHub Personal Access Token ƒë·ªÉ authentication..."
   ```

3. **Agent setup environment**:
   ```
   User: "ghp_your_token_here"
   Agent: "‚úÖ Environment ƒë√£ ƒë∆∞·ª£c setup! B√¢y gi·ªù t√¥i c√≥ th·ªÉ s·ª≠ d·ª•ng GitHub MCP tools..."
   ```

4. **Agent s·ª≠ d·ª•ng GitHub MCP Tools**:
   ```
   Agent s·ª≠ d·ª•ng MCPToolset ƒë·ªÉ call github-mcp-server:
   - get_repository: L·∫•y th√¥ng tin repo
   - get_repository_content: Xem files/folders
   - search_code: T√¨m ki·∫øm code
   - list_commits: Xem commit history
   - create_branch: T·∫°o branch m·ªõi
   - v√† nhi·ªÅu tools kh√°c...
   ```

## üõ†Ô∏è GitHub MCP Tools Available

Sau khi setup th√†nh c√¥ng, agent c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c tools t·ª´ github-mcp-server:

### Repository Management
- `get_repository`: Get repository information
- `get_repository_content`: Browse files and folders
- `search_repositories`: Search for repositories

### File Operations  
- `get_file_contents`: Read file content
- `search_code`: Search code across repository
- `get_directory_contents`: List directory contents

### Branch & Commit Management
- `list_branches`: List all branches
- `create_branch`: Create new branch
- `list_commits`: Get commit history
- `get_commit`: Get specific commit details

### Issue & PR Management (if available)
- `list_issues`: List repository issues
- `create_issue`: Create new issue
- `list_pull_requests`: List pull requests

## üîí B·∫£o m·∫≠t

### Token Security
- ‚úÖ Environment variable isolation
- ‚úÖ Kh√¥ng hardcode token trong code
- ‚úÖ Token validation
- ‚úÖ Secure storage recommendations

### Best Practices
- S·ª≠ d·ª•ng token v·ªõi expiration date
- Monitor token usage qua GitHub
- Revoke token n·∫øu nghi ng·ªù compromise
- Kh√¥ng commit token v√†o version control

## üß™ Testing

```bash
# Test individual tools
python -c "
from github_agent.tools import validate_github_url
print(validate_github_url('https://github.com/microsoft/vscode'))
"

# Run full demo
python example_usage.py

# Test v·ªõi ADK web
adk web
```

## ‚ö†Ô∏è Troubleshooting

### Common Issues

**1. "github-mcp-server not found" Error**
```bash
# Ki·ªÉm tra Go ƒë√£ c√†i ƒë·∫∑t ch∆∞a
go version

# C√†i ƒë·∫∑t github-mcp-server
go install github.com/github/github-mcp-server/cmd/github-mcp-server@latest

# Verify installation
which github-mcp-server
github-mcp-server --help

# Test ch·∫°y stdio mode
github-mcp-server stdio --help
```

**2. "FileNotFoundError" khi start MCPToolset**
```bash
# ƒê·∫£m b·∫£o Go bin directory trong PATH
echo $PATH | grep -q "$HOME/go/bin" || echo 'export PATH=$HOME/go/bin:$PATH' >> ~/.bashrc
source ~/.bashrc

# Ho·∫∑c add v√†o shell profile
export PATH=$HOME/go/bin:$PATH
```

**3. "MCPToolset connection failed"**
```bash
# Test github-mcp-server manually tr∆∞·ªõc
export GITHUB_PERSONAL_ACCESS_TOKEN="ghp_your_token_here"
github-mcp-server stdio

# Verify environment variables
echo $GITHUB_PERSONAL_ACCESS_TOKEN
```

**4. "Permission denied errors"**
```bash
# Check token permissions t·∫°i https://github.com/settings/tokens
# Token c·∫ßn c√≥ ƒë√∫ng scopes: repo, read:org, user:email

# Ki·ªÉm tra token format
python3 -c "
token = input('Enter token: ')
if token.startswith('ghp_') and len(token) == 40:
    print('‚úÖ Valid classic token format')
elif token.startswith('github_pat_'):
    print('‚úÖ Valid fine-grained token format')
else:
    print('‚ùå Invalid token format')
"
```

**5. "ADK import errors"**
```bash
# Verify ADK installation
pip install google-adk --upgrade
python -c "import google.adk; print('ADK OK')"

# Check MCPToolset specifically
python -c "from google.adk.tools.mcp_tool.mcp_toolset import MCPToolset; print('MCPToolset OK')"
```

**6. "Go version compatibility"**
```bash
# github-mcp-server requires Go 1.23+
go version

# Update Go if needed
# Visit https://golang.org/dl/ for latest version
```

### Debugging Steps

**Step 1: Verify Prerequisites**
```bash
# Check all prerequisites
echo "=== Checking Prerequisites ==="
echo "Go version:"
go version
echo "github-mcp-server location:"
which github-mcp-server
echo "ADK installation:"
pip show google-adk
```

**Step 2: Test github-mcp-server Standalone**
```bash
# Set up minimal test
export GITHUB_PERSONAL_ACCESS_TOKEN="your_token_here"
echo '{"jsonrpc": "2.0", "id": 1, "method": "initialize", "params": {"protocolVersion": "2024-11-05", "capabilities": {}, "clientInfo": {"name": "test", "version": "1.0.0"}}}' | github-mcp-server stdio
```

**Step 3: Test MCPToolset Connection**
```python
# Test MCPToolset t√°ch ri√™ng
import asyncio
from google.adk.tools.mcp_tool.mcp_toolset import MCPToolset, StdioServerParameters

async def test_connection():
    toolset = MCPToolset(
        connection_params=StdioServerParameters(
            command="github-mcp-server",
            args=["stdio"],
            env={"GITHUB_PERSONAL_ACCESS_TOKEN": "your_token"}
        )
    )
    tools = await toolset.get_tools()
    print(f"Found {len(tools)} tools")
    await toolset.close()

# asyncio.run(test_connection())
```

### Performance Tips

- **Caching**: github-mcp-server caches API responses ƒë·ªÉ gi·∫£m rate limiting
- **Rate Limiting**: GitHub API c√≥ [rate limits](https://docs.github.com/en/rest/rate-limit), h√£y s·ª≠ d·ª•ng authenticated tokens
- **Toolset Filtering**: S·ª≠ d·ª•ng `tool_filter` trong MCPToolset ƒë·ªÉ ch·ªâ load tools c·∫ßn thi·∫øt
- **Environment**: Set `--read-only` flag cho github-mcp-server n·∫øu ch·ªâ c·∫ßn read operations

### Getting Help

1. **GitHub Issues**: [github-mcp-server issues](https://github.com/github/github-mcp-server/issues)
2. **ADK Documentation**: [MCP Tools Guide](https://google.github.io/adk-docs/tools/mcp-tools/)
3. **MCP Protocol**: [Model Context Protocol Docs](https://modelcontextprotocol.io/)
4. **GitHub API**: [GitHub REST API Docs](https://docs.github.com/en/rest)

## üìÅ Project Structure

```
github-mcp-agent/
‚îú‚îÄ‚îÄ github_agent/               # Main package
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py            # Package initialization  
‚îÇ   ‚îú‚îÄ‚îÄ agent.py               # Main ADK agent v·ªõi MCPToolset
‚îÇ   ‚îú‚îÄ‚îÄ prompt.py              # Agent instructions & prompts
‚îÇ   ‚îî‚îÄ‚îÄ tools.py               # Custom validation & setup tools
‚îú‚îÄ‚îÄ pyproject.toml             # Project configuration
‚îú‚îÄ‚îÄ requirements.txt           # Python dependencies
‚îú‚îÄ‚îÄ setup.sh                   # Setup script (executable)
‚îú‚îÄ‚îÄ example_usage.py           # Demo usage example
‚îî‚îÄ‚îÄ README.md                  # Documentation
```

## ü§ù Contributing

1. Fork repository
2. Create feature branch
3. Add tests cho changes
4. Submit Pull Request

## üìÑ License

MIT License - xem LICENSE file ƒë·ªÉ bi·∫øt chi ti·∫øt

## üîó Links

- [GitHub MCP Server](https://github.com/github/github-mcp-server)
- [ADK Documentation](https://google.github.io/adk-docs/)
- [MCP Protocol](https://modelcontextprotocol.io/)
- [ADK MCP Tools Documentation](https://google.github.io/adk-docs/tools/mcp-tools/)

## üìû Support

- T·∫°o issue trong repository n√†y
- Check ADK documentation
- Review github-mcp-server documentation

---

**Ph√°t tri·ªÉn b·ªüi**: ADK Community  
**Phi√™n b·∫£n**: 0.1.0  
**Ng√¥n ng·ªØ**: Vietnamese / Ti·∫øng Vi·ªát üáªüá≥ 